<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>TEKY Learning Management System</title>
		<%= csrf_meta_tags %>
		<%= csp_meta_tag %>

		<!-- favicon icon -->
		<%= favicon_link_tag 'Logo-fav.ico' %>
			
		<!-- Main CSS-->
		<link rel="stylesheet" type="text/css" href="/admin_theme/css/main.css">
		<!-- Font-icon css-->
		<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	</head>
	<body class="app sidebar-mini">  
		<!-- Navbar-->
		<header class="app-header"><a class="app-header__logo" href="index.html"><%= image_tag("/admin_theme/images/logo-teky-small.png",class:"", style:"width:106px;height:50px;") %></a>
		  <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
		  <!-- Navbar Right Menu-->
		  <ul class="app-nav">
			<li class="app-search">
			  <input class="app-search__input" type="search" placeholder="Search">
			  <button class="app-search__button"><i class="fa fa-search"></i></button>
			</li>
			<!--Notification Menu-->
			<li class="dropdown"><a class="app-nav__item" href="#" data-toggle="dropdown" aria-label="Show notifications"><i class="fa fa-bell-o fa-lg"></i></a>
			  <ul class="app-notification dropdown-menu dropdown-menu-right">
				<li class="app-notification__title">You have 4 new notifications.</li>
				<div class="app-notification__content">
				  <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></span>
					  <div>
						<p class="app-notification__message">Lisa sent you a mail</p>
						<p class="app-notification__meta">2 min ago</p>
					  </div></a></li>
				  <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-danger"></i><i class="fa fa-hdd-o fa-stack-1x fa-inverse"></i></span></span>
					  <div>
						<p class="app-notification__message">Mail server not working</p>
						<p class="app-notification__meta">5 min ago</p>
					  </div></a></li>
				  <li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-success"></i><i class="fa fa-money fa-stack-1x fa-inverse"></i></span></span>
					  <div>
						<p class="app-notification__message">Transaction complete</p>
						<p class="app-notification__meta">2 days ago</p>
					  </div></a></li>
				  <div class="app-notification__content">
					<li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></span>
						<div>
						  <p class="app-notification__message">Lisa sent you a mail</p>
						  <p class="app-notification__meta">2 min ago</p>
						</div></a></li>
					<li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-danger"></i><i class="fa fa-hdd-o fa-stack-1x fa-inverse"></i></span></span>
						<div>
						  <p class="app-notification__message">Mail server not working</p>
						  <p class="app-notification__meta">5 min ago</p>
						</div></a></li>
					<li><a class="app-notification__item" href="javascript:;"><span class="app-notification__icon"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-success"></i><i class="fa fa-money fa-stack-1x fa-inverse"></i></span></span>
						<div>
						  <p class="app-notification__message">Transaction complete</p>
						  <p class="app-notification__meta">2 days ago</p>
						</div></a></li>
				  </div>
				</div>
				<li class="app-notification__footer"><a href="#">See all notifications.</a></li>
			  </ul>
			</li>
			<!-- User Menu-->
			<li class="dropdown"><a class="app-nav__item" href="#" data-toggle="dropdown" aria-label="Open Profile Menu"><i class="fa fa-user fa-lg"></i></a>
			  <ul class="dropdown-menu settings-menu dropdown-menu-right">
				<li><a class="dropdown-item" href="page-user.html"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
				<li><a class="dropdown-item" href="page-user.html"><i class="fa fa-user fa-lg"></i> Profile</a></li>
				<li><a class="dropdown-item" href="page-login.html"><i class="fa fa-sign-out fa-lg"></i> Logout</a></li>
			  </ul>
			</li>
		  </ul>
		</header>

		<!-- Sidebar menu-->
		<div class="app-sidebar__overlay" data-toggle="sidebar"></div>
		<aside class="app-sidebar">
			<div class="app-sidebar__user">
				<%= image_tag(get_avatar, class:"app-sidebar__user-avatar") %>
		        <div>
		          <p class="app-sidebar__user-name"><%= current_user.username %></p>
		          <p class="app-sidebar__user-designation">Admin</p>		          
		      </div>
		    </div>
		    <%= get_menus_admin(request.original_fullpath).html_safe%>
		</aside>
		<main class="app-content">
      <div class="app-title">
        <div>
              <h1><%= @report_title_page %></h1>
        </div>
      </div>
      <%= yield %>            
		</main>
  
		<!-- Essential javascripts for application to work-->
		<script src="/admin_theme/js/jquery-3.3.1.min.js"></script>
		<script src="/admin_theme/js/popper.min.js"></script>
		<script src="/admin_theme/js/bootstrap.min.js"></script>
		<script src="/admin_theme/js/main.js"></script>
		<!-- The javascript plugin to display page loading on top-->
		<script src="/admin_theme/js/plugins/pace.min.js"></script>
		<!-- Page specific javascripts-->
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
    <script>
        var ctx = document.getElementById('reportDiligentMonthlyScale').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [
                  <% @data_company.each do |ct| %>
                    '<%= ct[:name]%>',
                  <% end %>  
                ],
                datasets: [{
                    label: '<%= t("Report.report_attend_title")%>',
                    data: [<% @data_company.each do |ct| %>'<%= ct[:scale_present] %>',<% end %>],
                    backgroundColor: 'rgb(54, 162, 235)',
                    borderWidth: 0
                },
                {
                      label: '<%= t("Report.report_absent_title")%>',
                      data: [<% @data_company.each do |ct| %>'<%= ct[:scale_no_present] %>',<% end %>],
                      backgroundColor: 'rgb(201, 203, 207)',
                      borderWidth: 0
                }     
                ],			
            },
            options: {
                      title: {
                          display: true,
                          text: '<%= t("Report.report_chart_prorata_title")%>',
                          fontSize: '14'
                      },  
                      tooltips: {
                          callbacks: {
                              label: function(tooltipItem, data) {
                                  var label = data.datasets[tooltipItem.datasetIndex].label || '';              
                                  if (label) {
                                      label += ': ';
                                  }
                        
                                  label += Math.round(tooltipItem.yLabel * 100) / 100;
                        
                                  label += '%';
                        
                                  return label;
                              }
                          },
                          mode: 'index',
                          intersect: false
                        },
                        responsive: true,
                        maintainAspectRatio:false,
                        scales: {
                          xAxes: [{
                            stacked: true,
                          }],
                          yAxes: [{
                            stacked: true,
                            ticks: {
                                min: 0,
                                max: 100,
                                stepSize: 10,
                                callback: function(value, index, values) {
                                    return value + ' %';
                                }
                            }
                          }]
                        },
            }
        });
    </script>
    <script>
        var ctx = document.getElementById('reportDiligentMonthlyNumber').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [
                  <% @data_company.each do |ct| %>
                    '<%= ct[:name]%>',
                  <% end %>  
                ],
                datasets: [{
                  label: '<%= t("Report.report_attend_title")%>',
                    data: [<% @data_company.each do |ct| %>'<%= ct[:student_present] %>',<% end %>],
                    backgroundColor: 'rgb(54, 162, 235)',
                    borderWidth: 0
                },
                {
                      label: '<%= t("Report.report_absent_title")%>',
                      data: [<% @data_company.each do |ct| %>'<%= ct[:student_no_present] %>',<% end %>],
                      backgroundColor: 'rgb(201, 203, 207)',
                      borderWidth: 0
                }     
                ],      
            },
            options: {
                      title: {
                          display: true,
                          text: '<%= t("Report.report_chart_based_on_quantity_title")%>',
                          fontSize: '14'
                      },
                      legend: { display: true },  
                      tooltips: {
                          callbacks: {
                              label: function(tooltipItem, data) {
                                  var label = data.datasets[tooltipItem.datasetIndex].label || '';              
                                  if (label) {
                                      label += ': ';
                                  }
                        
                                  label += Math.round(tooltipItem.yLabel * 100) / 100;
                        
                                  return label;
                              }
                          },
                          mode: 'index',
                          intersect: false
                        },
                        responsive: true,
                        maintainAspectRatio:false,
                        scales: {
                          xAxes: [{
                            stacked: true,
                          }],
                          yAxes: [{
                              stacked: true,
                            ticks: {
                              min: 0,
                              stepSize: 200
                              }
                          }]
                        },
            }
        });
    </script>
	</body>
</html>  